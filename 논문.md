# 제3장 Gemini-CLI 기반 지반 안정성 평가 모델 구축

## 3.1. 연구 방법론 개요

본 연구는 대규모 언어 모델(LLM)인 Gemini를 커맨드 라인 인터페이스(CLI) 환경에서 활용하여, 방대한 비정형(unstructured) 지반 조사 데이터로부터 공학적으로 유의미한 정보를 추출하고, 이를 정형 데이터(structured data)로 변환하여 석회암 지반의 위험도를 자동으로 평가하는 모델을 구축하는 것을 목표로 한다.

전통적인 지반 데이터 분석은 숙련된 엔지니어의 경험에 크게 의존하며, 보고서의 양이 방대할 경우 일관성 저하나 정보 누락의 위험이 상존한다. 본 연구에서 제안하는 모델은 이러한 한계를 극복하기 위해, 생성형 AI를 **'보조 지반 기술사(Assistant Geotechnical Engineer)'**로 기능하게 하여 분석의 자동화, 일관성, 확장성을 확보하고자 한다.

## 3.2. 시스템 아키텍처 설계

본 연구에서 제안하는 지반 안정성 평가 모델의 전체 시스템 아키텍처는 **[그림 3-1]**과 같다. 데이터 처리 파이프라인은 총 4단계로 구성된다.

```
+----------------+   +-------------------+   +-----------------------+   +---------------------+
|   1. 데이터    |   |   2. 텍스트 변환  |   |    3. Gemini-CLI      |   |   4. 데이터베이스 및  |
| 수집 및 디지털화 |—> |  (전처리)         |—> |     분석 및 정형화    |—> |      시각화         |
+----------------+   +-------------------+   +-----------------------+
| - PDF/이미지 형태의|   | - OCR 기술 활용   |   | - 프롬프트 엔지니어링   |   | - JSON 결과를 DB에 저장|
|  시추 주상도,    |   | - TXT 포맷으로     |   | - 역할(Persona) 부여    |   | - 3D 지반 모델링 연계 |
|  지반조사 보고서   |   |   일괄 변환       |   | - 위험도 평가 모델      |   | - 지반 디지털 트윈   |
+----------------+   +-------------------+   +-----------------------+
```
**[그림 3-1] Gemini-CLI 기반 지반 안정성 평가 시스템 아키텍처**

1.  **데이터 디지털화:** 원시 데이터인 PDF 형태의 지반 조사 보고서를 광학 문자 인식(OCR) 기술을 이용하여 분석 가능한 텍스트(TXT) 파일로 변환한다.
2.  **전처리:** 변환된 텍스트 데이터에서 분석에 필요한 핵심 정보(시추 기록 등)를 추출할 수 있도록 정제한다.
3.  **Gemini-CLI 분석 및 정형화:** 본 연구의 핵심 단계로, CLI 환경에서 특정 프롬프트를 사용하여 Gemini 모델이 텍스트 데이터를 분석하고, 그 결과를 미리 정의된 JSON 형식으로 출력하게 한다.
4.  **데이터베이스 및 시각화:** 생성된 JSON 데이터를 데이터베이스(DB)에 저장하여 관리하고, 이를 3D 지반 모델링 소프트웨어 등과 연계하여 시각화함으로써 최종 의사결정을 지원한다.

## 3.3. 프롬프트 엔지니어링 기반 위험도 평가 모델

대규모 언어 모델의 성능은 프롬프트의 설계에 따라 크게 좌우된다. 본 연구에서는 Gemini가 단순 정보 검색을 넘어, 전문적인 공학적 판단을 수행하도록 유도하기 위해 다음과 같이 프롬프트를 설계하였다. 이는 LLM이 주어진 맥락(Context) 내에서 추론하고 학습하는 **'In-Context Learning'** 능력을 극대화하기 위함이다.

### 3.3.1. 입력 데이터셋 예시

모델의 입력값은 아래 **[표 3-1]**과 같이 정제된 시추 주상도 텍스트 파일이다.

**[표 3-1] 입력 데이터 예시 (`borehole_log_ex01.txt`)**
```text
시추공 번호: BH-01
좌표: 37.123, 127.456
표고: 125.5m

--- [ 시추 기록 ] ---
심도(m) | 층서 | 암종/토층 | 코어회수율(%) | RQD(%) | 주요 관찰 내용
--------------------------------------------------------------------------------
...
8.5-9.2 | 연암 | 석회암 | 50 | 0 | 코어 유실 심함. 점토 충전물 다수 관찰.
...
12.5-13.0| 보통암| 석회암 | 30 | 0 | 공내수 순환 안됨. 공동 의심.
...
--------------------------------------------------------------------------------
종합 의견: 심도 8.5m와 12.5m 구간에서 석회암 공동 존재 가능성 매우 높음.
```

### 3.3.2. 프롬프트 구성요소 및 설계

프롬프트는 **1) 역할 정의(Persona), 2) 규칙 및 판단 기준(Rules), 3) 출력 형식(Output Format)**의 세 가지 핵심 요소로 구성된다.

**[표 3-2] Gemini-CLI 실행을 위한 프롬프트 설계**
```bash
gemini @borehole_log_ex01.txt \
"
# 1. 역할 정의 (Persona)
너는 20년 경력의 철도 토질 및 기초 기술사이다.

# 2. 규칙 및 판단 기준 (Rules)
너의 임무는 주어진 시추 주상도 데이터를 분석하여 석회암 공동의 위험도를 평가하는 것이다.
- 핵심 분석 지표: 코어회수율(%), RQD(%), '주요 관찰 내용', '종합 의견'을 종합적으로 판단한다.
- 위험도 판단 기준:
  - '위험(High)': RQD 0%, '공동', '시추수 누수' 등 직접적 징후.
  - '의심(Medium)': RQD < 50%, '파쇄대', '점토 충전' 등 간접적 징후.
  - '보통(Low)': RQD > 75%지만, 석회암 지반의 잠재적 위험 존재.

# 3. 출력 형식 (Output Format)
반드시 아래 JSON 구조로만 응답하고, 다른 설명은 절대 추가하지 마라.
{
  \"borehole_id\": \"...\",
  \"risk_zones\": [
    {
      \"depth_start\": ...,
      \"risk_level\": \"...\",
      \"evidence\": \"(판단의 근거가 된 내용 요약)\" 
    }
  ],
  \"recommendation\": \"...\"
}

# 4. 최종 명령
위 규칙에 따라, 첨부된 파일을 분석하여 결과를 JSON 형식으로 출력하라.
"
```

이러한 프롬프트 설계는 다음과 같은 학술적, 공학적 의미를 갖는다.
- **역할 정의**는 모델이 일반적인 답변이 아닌, 특정 도메인(지반 공학)의 전문가적 지식 체계 내에서 추론하도록 유도한다.
- **판단 기준**을 명시적으로 제공함으로써, 모델의 분석 결과에 일관성을 부여하고 연구자가 원하는 평가 기준을 정확하게 반영할 수 있다.
- **출력 형식**을 JSON으로 강제함으로써, 후속 처리(데이터베이스 저장, 시각화)가 용이한 기계 가독적(machine-readable) 데이터를 확보할 수 있다.
- 특히 `evidence` 필드는 모델이 왜 특정 구간을 'High' 또는 'Medium'으로 판단했는지 근거를 명시하게 함으로써, 최근 AI 분야에서 중요성이 커지고 있는 **설명 가능한 AI(Explainable AI, XAI)**의 원칙을 구현한 것이다. 이는 AI의 판단 과정을 인간 전문가가 검토하고 신뢰할 수 있게 만드는 핵심적인 요소이다.

## 3.4. 분석 결과(JSON)의 정형화 및 활용

상기 프롬프트를 통해 Gemini-CLI를 실행하면, 모델은 비정형 텍스트를 분석하여 아래 **[표 3-3]**과 같은 정형화된 JSON 객체를 출력한다.

**[표 3-3] Gemini-CLI의 JSON 출력 결과 예시**
```json
{
  "borehole_id": "BH-01",
  "analysis_summary": "시추공 BH-01에서 2개의 석회암 공동 위험 구간이 식별되었으며...",
  "risk_zones": [
    {
      "depth_start": 8.5, "depth_end": 9.2,
      "risk_level": "Medium",
      "evidence": "RQD 0%, 코어 유실 심함(50%), 점토 충전물 다수 관찰됨."
    },
    {
      "depth_start": 12.5, "depth_end": 13.0,
      "risk_level": "High",
      "evidence": "RQD 0%, 코어회수율 30%, 공내수 순환 안됨. 개방 공동으로 강력히 의심됨."
    }
  ],
  "recommendation": "정밀 물리탐사 및 추가 시추공 천공 권고."
}
```

이렇게 생성된 정형 데이터는 본 연구의 최종 목표를 달성하기 위한 핵심적인 중간 산출물이다. 이 데이터는 Python 스크립트 등을 통해 데이터베이스에 자동으로 적재될 수 있으며, 수백, 수천 개의 시추공 데이터가 누적되면 광역적인 지반 위험도 평가가 가능해진다.

더 나아가, 이 정형 데이터는 3D 지반 모델링 소프트웨어(예: Civil 3D, GeoVia)의 API와 연동하여, 특정 좌표와 심도에 해당하는 위험 구간을 3차원 공간상에 시각화할 수 있다. 이는 최근 건설 분야에서 활발히 연구되고 있는 **지반 디지털 트윈(Geotechnical Digital Twin)**을 구축하는 foundational data layer로서 기능할 수 있으며, 이를 통해 노선 계획 단계에서 설계자가 시각적으로 위험 구간을 인지하고 최적의 노선을 직관적으로 선정하는 데 기여할 수 있다.
